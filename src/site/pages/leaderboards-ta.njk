---
title: Leaderboards
---
{% import "components/macros.njk" as macros %}

{% set archTemperedQuests = [
    '9‚òÖ-a-whisper-of-white-mane',
    '9‚òÖ-the-deathly-quiet-curtain',
    '9‚òÖ-like-a-moth-to-the-flame',
    '9‚òÖ-the-eye-of-the-storm',
    '9‚òÖ-the-heralds-of-destruction-cry',
    '9‚òÖ-the-scorn-of-the-sun',
    '9‚òÖ-when-blue-dust-surpasses-red-lust',
    '9‚òÖ-a-visitor-from-eorzea',
    '9‚òÖ-a-visitor-from-eorzea-extreme'
] %}

{% set numQuests = archTemperedQuests | length %}
{% set maxTrophies = numQuests * 3 * 14 %}

<h1>Leaderboards TA Wiki Rules</h1>
{% set runner = collections.lookup.runner[ 'hczs' ] %}
<p>
    Note: This is a quick hack meant for {% include "components/links/runner-link.njk" %}.
    Do not bookmark this page as it may change in the future.
</p>
<dl>
    <dt>Quests</dt>
    <dd>
        <ul>
            {# --- see .eleventy for `archTemperedLeague` --- #}
            {% for questSlug in archTemperedQuests %}
            {% set quest = collections.lookup.quest[ questSlug ] %}
                <li><a href="{{ quest.url | url }}">{{ quest.data.title }}</a></li>
            {% endfor %}
        </ul>
    </dd>
    <dt>Rules</dt>
    <dd>TA Wiki Rules</dd>
    <dt>Notes</dt>
    <dd>
        <p>
            For every quest ({{ numQuests }}), there are three trophies (3) per weapon (14) for a total of <strong>{{ maxTrophies }}</strong> trophies!<br>
            A runner can only have one trophy per weapon and quest combination.<br>
            In case of multiple runs, only the fastest run is count.<br>
            <br>
            Note: Click on a row to expand the collected trophies!
        </p>
    </dd>
</dl>

<div class="table-wrapper">
    <table class="summary leaderboards">
        <tr>
            <th scope="col">Rank</th>
            <th scope="col">Runner</th>
            <th scope="col" class="summary__head--huge">{{ macros.icon_svg('award', 'gold') }}</th>
            <th scope="col" class="summary__head--huge">{{ macros.icon_svg('award', 'silver') }}</th>
            <th scope="col" class="summary__head--huge">{{ macros.icon_svg('award', 'bronze') }}</th>
            <th scope="col">Total</th>
        </tr>
        {% set previousTrophyHash   = false %}
        {% set previousRank         = 1 %}
        {% set totalTrophiesClaimed = 0 %}
        {% for trophyCollection in collections.xxxta %}
            {% set runner = trophyCollection.runner %}
            {% set totalTrophies = trophyCollection.gold + trophyCollection.silver + trophyCollection.bronze %}
            {% set totalTrophiesClaimed = totalTrophiesClaimed + totalTrophies %}
            {# -- Simple extra check for same amount of trophy holders to keep the same rank -- #}
            {% set trophyHash = trophyCollection.gold + "--" + trophyCollection.silver + "--" + trophyCollection.bronze %}
            {% if previousTrophyHash === trophyHash %}
                {% set leaderboardRank = previousRank %}
            {% else %}
                {% set leaderboardRank    = loop.index %}
                {% set previousTrophyHash = trophyHash %}
                {% set previousRank       = loop.index %}
            {% endif %}
            {% if totalTrophies > 0 %}
            <tr class="toggle-runs">
                <td>
                    {#
                    {% if leaderboardRank == 1 %}
                        ü•á
                    {% elseif leaderboardRank == 2 %}
                        ü•à
                    {% elseif leaderboardRank == 3 %}
                        ü•â
                    {% else %}
                        {{ leaderboardRank }}
                    {% endif %}
                    #}
                    {{ leaderboardRank }}
                </td>
                <td scope="row">
                    <a href="{{ runner.url | url }}">{{- runner.data.title -}}</a>
                    {% if runner.data.country %}
                        <span class="flag-icon flag-icon-{{ runner.data.country }}"></span>
                    {% endif %}
                    {#
                    {% if leaderboardRank == 1 %}
                        üèÜ
                    {% endif %}
                    #}
                </td>
                <td>{{ trophyCollection.gold }}</td>
                <td>{{ trophyCollection.silver }}</td>
                <td>{{ trophyCollection.bronze }}</td>
                <td>{{ totalTrophies }}</td>
            </tr>
            <tr hidden class="">
                <td colspan=6 style="text-align: left;">
                    <p>
                        {% for trophy in trophyCollection.trophies %}
                            {% if trophy.rank == 1 or trophy.rank == 2 or trophy.rank == 3 %}
                                {% set weaponSlug = trophy.run.data.weapons | first %}
                                {% set weapon = collections.lookup.weapon[ weaponSlug ] %}
                                    {% if trophy.rank == 1 %}
                                        {{ macros.icon_svg('award', 'gold') }}
                                    {% elseif trophy.rank == 2 %}
                                        {{ macros.icon_svg('award', 'silver') }}
                                    {% elseif trophy.rank == 3 %}
                                        {{ macros.icon_svg('award', 'bronze') }}
                                    {% else %}
                                        [{{ trophy.rank }}]
                                    {% endif %}
                                    <a href="{{ trophy.run.url }}">
                                        <strong>{{ trophy.quest.data.title }}</strong> with <strong>{{ weapon.data.title }}</strong>.
                                    </a>
                                {% if not loop.last %}
                                    <br>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </p>
                </td>
            </tr>
            {% endif %}
        {% endfor %}
        <tr>
            <td colspan=5 style="text-align: left;">
                Total trophies claimed so far:
            </td>
            <td>
                {{ totalTrophiesClaimed }} / {{ maxTrophies }}
            </td>
        </tr>
    </table>
</div>
